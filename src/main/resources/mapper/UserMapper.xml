<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0/EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.thc.fallsprbasic.mapper.UserMapper">
    <select id="detail" parameterType="hashMap" resultType="com.thc.fallsprbasic.dto.UserDto$DetailResDto">
        SELECT user.id
             , user.deleted
             , user.created_at as createdAt
             , user.modified_at as modifiedAt
             , user.name
             , user.phone
             , user.id as id
             , user.username as userUsername
        FROM user
                 LEFT JOIN faq
                           ON faq.user_id = user.id
        WHERE faq.id = #{id}
    </select>
    <select id="list" parameterType="hashMap" resultType="com.thc.fallsprbasic.dto.UserDto$DetailResDto">
        SELECT user.id
        FROM user
        WHERE user.id is not NULL
        <if test = "deleted != null and deleted !=''">AND user.deleted = #{deleted}</if>
        <if test = "title != null and title !=''">AND user.title LIKE CONCAT('%', #{title}, '%')</if>

    </select>
    <select id="pagedList" parameterType="hashMap" resultType="com.thc.fallsprbasic.dto.UserDto$DetailResDto">
        SELECT faq.id
        FROM faq
        WHERE faq.id is not NULL
        <if test = "deleted != null and deleted !=''">AND user.deleted = #{deleted}</if>
        <if test = "title != null and title !=''">AND user.title LIKE CONCAT('%', #{title}, '%')</if>
        <if test = "orderby != null and orderby !='created_at'">ORDER BY user.created_at</if>
        <if test = "orderby != null and orderby !='title'">ORDER BY user.title</if>
        <if test = "orderway != null and orderway !='desc'">DESC</if>
        <if test = "orderway != null and orderway !='asc'">ASC</if>
        LIMIT #{offset}, #{perpage}
    </select>
    <select id="pagedCount" parameterType="hashMap" resultType="Integer">
        SELECT count(faq.id) as listsize
        FROM faq
        WHERE faq.id is not NULL
        <if test = "deleted != null and deleted !=''">AND faq.deleted = #{deleted}</if>
        <if test = "title != null and title !=''">AND faq.title LIKE CONCAT('%', #{title}, '%')</if>
    </select>
    <select id="scrollList" parameterType="hashMap" resultType="com.thc.fallsprbasic.dto.FaqDto$DetailResDto">
        SELECT faq.id
        FROM faq
        WHERE faq.id is not NULL
        <if test = "deleted != null and deleted !=''">AND faq.deleted = #{deleted}</if>
        <if test = "title != null and title !=''">AND faq.title LIKE CONCAT('%', #{title}, '%')</if>
        <if test = "orderway != null and orderway !='desc'">
          <if test = "createdAt !=null and createdAt != ''">AND #{createdAt}>faq.created_at</if>
          ORDER BY faq.created_at DESC
        </if>
        <if test = "orderway != null and orderway !='asc'">
            <if test = "createdAt !=null and createdAt != ''">AND #{createdAt}>faq.created_at</if>
            ORDER BY faq.created_at ASC
        </if>

        LIMIT 0, #{perpage}
    </select>

</mapper>